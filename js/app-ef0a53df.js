function playSound(t,e,o){if(e&&!paused){var r=t.createBufferSource();r.buffer=e,r.connect(t.destination),r.start(o)}}function BufferLoader(t,e,o){this.context=t,this.urlList=e,this.onload=o,this.bufferList=new Array,this.loadCount=0}function toggle_music(){paused=!paused;var t=document.getElementById("pause");t.textContent=paused?"Play":"Pause"}function toggle_beat(t){var e=t.dataset.row,o=t.dataset.column;for(var r in button_on){var n=button_on[r];t.classList.toggle(n)}music_map[e][o]^=1}var paused=!1,music_map=[[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0]],button_on="btn--blue".split(" "),highlight="bg-light-orange b--dark-orange ba bw5".split(" ");document.addEventListener("DOMContentLoaded",function(){var t=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),e=4,o=96,r=60/o/e,n=["music/clicks.mp3","music/hat.mp3","music/kick.mp3","music/snare.mp3"],a=[],i=new BufferLoader(t,n,function(t){a=t});i.load();for(var u in music_map)for(var s in music_map[u])if(music_map[u][s])for(var d in button_on){var c=button_on[d],l=document.querySelectorAll(".beat[data-column='"+s+"'][data-row='"+u+"']");l[0].classList.toggle(c)}{var f=0,m=t.currentTime,p=r;window.setInterval(function(){for(var o=8*m*p,r=0;e>r;r++)music_map[r][f]&&playSound(t,a[r],o);for(var r in a){prev_col=(f+(e-1))%e;var n=document.querySelectorAll(".beat[data-column='"+prev_col+"']"),i=document.querySelectorAll(".beat[data-column='"+f+"']");for(var u in highlight){var s=highlight[u];n.item(r).classList.remove(s),i.item(r).classList.add(s)}}f=(f+1)%e},1e3*r)}}),BufferLoader.prototype.loadBuffer=function(t,e){var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer";var r=this;o.onload=function(){r.context.decodeAudioData(o.response,function(o){return o?(r.bufferList[e]=o,void(++r.loadCount==r.urlList.length&&r.onload(r.bufferList))):void alert("error decoding file data: "+t)},function(t){console.error("decodeAudioData error",t)})},o.onerror=function(){alert("BufferLoader: XHR error")},o.send()},BufferLoader.prototype.load=function(){for(var t=0;t<this.urlList.length;++t)this.loadBuffer(this.urlList[t],t)};