function playSound(t,e,o){if(e&&!paused){var n=t.createBufferSource();n.buffer=e,n.connect(t.destination),n.start(o)}}function BufferLoader(t,e,o){this.context=t,this.urlList=e,this.onload=o,this.bufferList=new Array,this.loadCount=0}function toggle_music(){paused=!paused;var t=document.getElementById("pause");t.textContent=paused?"Play":"Pause"}function toggle_beat(t){var e=t.dataset.row,o=t.dataset.column;for(var n in button_on){var r=button_on[n];t.classList.toggle(r)}music_map[e][o]^=1}var paused=!1,music_map=[[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],button_on="btn--blue".split(" "),highlight="bg-light-orange b--dark-orange ba bw5".split(" ");document.addEventListener("DOMContentLoaded",function(){var t=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),e=16,o=4,n=music_map.length,r=96,a=60/r/o,i=["music/clicks.mp3","music/hat.mp3","music/kick.mp3","music/snare.mp3"],u=[],s=new BufferLoader(t,i,function(t){u=t});s.load();for(var d in music_map)for(var c in music_map[d])if(music_map[d][c])for(var l in button_on){var f=button_on[l],m=document.querySelectorAll(".beat[data-column='"+c+"'][data-row='"+d+"']");m[0].classList.toggle(f)}{var p=0,v=t.currentTime,g=a;window.setInterval(function(){for(var o=8*v*g,r=0;n>r;r++)music_map[r][p]&&playSound(t,u[r],o);for(var r in u){prev_col=(p+(e-1))%e;var a=document.querySelectorAll(".beat[data-column='"+prev_col+"']"),i=document.querySelectorAll(".beat[data-column='"+p+"']");for(var s in highlight){var d=highlight[s];a.item(r).classList.remove(d),i.item(r).classList.add(d)}}p=(p+1)%e},1e3*a)}}),BufferLoader.prototype.loadBuffer=function(t,e){var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer";var n=this;o.onload=function(){n.context.decodeAudioData(o.response,function(o){return o?(n.bufferList[e]=o,void(++n.loadCount==n.urlList.length&&n.onload(n.bufferList))):void alert("error decoding file data: "+t)},function(t){console.error("decodeAudioData error",t)})},o.onerror=function(){alert("BufferLoader: XHR error")},o.send()},BufferLoader.prototype.load=function(){for(var t=0;t<this.urlList.length;++t)this.loadBuffer(this.urlList[t],t)};